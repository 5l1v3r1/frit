Forensic Robust Investigation Toolkit

1. Introduction

The idea behind frit was inspired by the use of git.
It's a command line tool to ease the use of already avaliable
open source forensic tools.
It will help in file triage and dealing with multiple forensic
aquired images.

For example, it will mount and unmount filesystems when needed.
You can even launch different tasks at the same time in different consoles.
Frit will take care of locking mounted filesystems to avoid that another
instance unmount the filesystems accidentally.

Frit is written in Python.

2. Dependencies

elixir (python-elixir)
sqlaclhemy (python-sqlalchemy)
configobj (python-configobj)
fuse iso (fuse-iso)
libpff (not yet in debian repositories)

3. Installation

to be written

4. prerequisite

The following prerequisite and advises have to be carrefully read.
You must understand what you do because they could be a security risk
in untrusted environement.
They are to be used when you are the only user of the machine or when
you absolutely trust all the users of the frit program AND the users of
the machine where it's installed.

4.1 Loop devices

Make sure there are enough free loop devices on the system, for example,
modify /etc/modules and insert this line:
loop max_loop=64
This will make 64 loop devices available.

4.2 Block devices

Make sure that the user can use the block devices.
On Debian it have to belong to the 'disk' group.

4.3 NTFS-3G

Make sure that your user can use ntfs-3g, for example: 
 - add an ntfsuser group
 - make your user belonging to this group
 - change the group of the ntfs-3g binary:
   sudo chown root.ntfsuser $(which ntfs-3g)
 - make the ntfs-3g binary suid root and only executable by the group:
    sudo chmod 4750 $(which ntfs-3g)

4.4 sudo

Frit sometimes needs root privileges, for example when it need to mount a
filesystem like FAT.
For this, it uses the "sudo" command. Sudo will ask for password when needed
but most of the time, the user will not be in front of the console when it
happens.
That's why you may want to allow your user to gain root privileges when using
frit without the need of a password.
Be aware of the security risk.

5. Usage

Frit is a command line tool. The synospis is:
frit COMMAND ARGS [EvidenceX/File Name] [EvidenceY/File Name] ...

5.1 Init

First of all, forensic evidences have to be placed in a same directory tree.
At the root of this tree :
$ frit init

The init command will create the hidden diretory .frit and will create a
basic configuration file .frit/config.

This config file have to be edited and modified in order to have:
A section by evidence file and a subsection by filesystem found on this
evidence.

For example:
[Evidence1]
    Name=pc-badguy.aff
    Format=aff
    [[Filesystem1]]
        Format=NTFS
        Offset=63*512
[Evidence2]
    Name=pc-badguy2.aff
    Format=aff
    [[Filesystem1]]
        Format=NTFS
        Offset=32256
    [[Filesystem2]]
        Format=VFAT
        Offset=71328600*512

The "Name" parameter is the filepath to the evidence.
The "Format" parameter in the evidence section is the format used by the
forensic image (frit currently supported raw files (dd), aff (advenced forensic
format and ewf (encase)).

The "Filesystem#number" subsection must contain the format of this filesystem
(frit currently support
NTFS and vfat) and the offset in bytes where to find this filesystem on the
image.

5.2 add

The "add" command is used to add an evidence to the config file, without
manually edit this config file.

The arguments to the "add" command are file names of the evidences that
you want to add.

Frit will try to identify wich kind of container it is.
Then it will mount the container and try to probe for the filesystems
that are present in this container.

At this moment, Frit is able to recognize thos containers:
- raw DD
- AFF
- EWF

The filesystems recognized are:
- NTFS
- FAT

The partitioning schemes recognized are:
- MSDOS partition types
- No partitioning at all

5.3 mount

The "mount" command will mount each filesystem from each evidence.
It's useful to test that your configuration file is working.
The filesystems are mounted in
".frit/filesystems/Evidence#number/Filesystem#number".

You can then use them normally.

If you are only intersted in mounting containers to access a raw image,
for example to use a carving tool on the raw image, you can use the "mount
containers" command.

5.4 store

Frit use a sqlite3 database to store various elements about the files.
The database itself is a simple slite file stored in ".frit/frit.sqlite".

The metadata that will be stored in the database are:
files names, files pathes, avalaible files dates, files mime types, files
extensions,
md5, sha1 and ssdeep hashes ... and more to come.

The first step is to create the initial database with the command :
$ frit store create

This will mount the filesystems if needed and will store basic informations
about files: pathes, names, dates and extensions.

If you decide to add a new evidence in your case, you will have to updae the
database.
Use the "store update" command for this purpose.
Once you added the new evidence in your config file, use:
$ frit store update

5.5 extensions

The extension command is used to manipulate files based on their extensions.
This command has to be used after the "store init" command is finished.

5.5.1 Counting extensions

$ frit extensions count
This command will list all extensions found on the filesystems along with their
numbers and the total size used by them.

If you pass an extension list as parameter, it will show the count for those
extensions only.
For example, if you want to count "xls" and "doc" files, use this command:
$ frit extensions count .xls .doc

5.5.2 List files matching an extension criteria

If you want to list all files with an "xls" extension, you can try this command:
$ frit extensions list .xls

It will list the full pathname (including the "./frit/..." part) of the ".xls"
files. You can use more than one criteria. If you omit an extension criteria, it
will list all files, sorted by their extension.

5.5.3 Extract files based on their extensions

Let's imagine that we want to extract all "pdf" and "xls" from all evidences.
You can use this command:
$ frit extensions extract .pdf .xls

This will extract the corresponding files in the directory
".frit/extractions/by_extensions/Evidence#number/filesystem#number/extension/..."
The fullpath will be reconstructed behind this path.

If you don't want to have a directory by extension, use the merge option like
this:
$ frit extensions extract --merge .pdf .xls .doc

5.6 hashes

This command is used to manipulate file hashes in frit environment.
This command need arguments.
To manipulate hashes, you first need to have a initial database, so you need
to use the store command first.
$ frit store create

5.6.1 Update the database

The update command will calculates md5, sha1, sha256 and ssdeep hashes for all
files and update the database.

$ frit hashes update

5.6.2 Searching for hashes

You can search for md5 like this:
$ frit hashes md5search a743b

This command will search for a md5 hash begining by "a743b".
A hash to search have at least to be 3 characters long.
sha1 and sha256 can be searched with sha1search and sha256search

5.6.3 Searching for ssdeep hashes

to be done

5.6.4 csv dump of database

You can dump the all database with this command:
$ frit hashes csvdump

It will dump the db like this:
Evidence name, File system name ,file name , md5 hash, sha1 hash, sha256 hash, 
ssdeep hash, file state

5.7 undelete

Perform an undelete on filesystems and store the results in
'.frit/extractions/undeleted'.

Currently only ntfs is supported.

5.8 getmails

Search for PST outlook mailboxes files and extract their mails and
attachments using libpff.

5.9 status

The status command give a status of the frit system.
It parses the config file and describe the systems.
It shows if a container or a filesystem is locked by another instance of frit.
It also shows if a container or a filesystem is mounted.

5.9.1 status clean

In case of a crash or for another reason, the frit environement can be left in 
an inconsistent state.
For example:
- A file system is mounted but not locked
- A file system is locked but not mounted
- A file system is locked but the process which locked it is not running anymore
...

Those inconsistencies are shown in red. If the user want to clean it, he can
launch this command:
$ frit status clean

It's possible that a clean command result in another inconsistency. In this case
the user have to launch this command until the system is completely clean.

5.9.2 database status

It's possible to have information about the frit sqlite database by issuing this
command:
$ frit status database

5.10 Specify an evidence

You can specify on which Evidence(s) you want to work on the command line.
For example, if you want to mount only the "Evidence3" and their filesystems,
you can use this command:

$ frit mount Evidence3

You could also specify multiple ones. For example, this command will count
.xls .doc and .jpg extensions for Evidence3 and Evidence 5:

$ frit extensions count .xls .doc .jpg Evidence3 Evidence5

It's also possible to specify an Evidence by its file name like this:

$ frit store update my_nice_container.ewf

6. Future

What is palnned in the future releases:
- carving
- file hashing
- file indexing
- ...

